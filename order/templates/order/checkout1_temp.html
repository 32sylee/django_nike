{% load humanize %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>
<body>
<h3>주문내역</h3>
{% for item in order_list %}
<img src="{{ item.inventory.product_id.thumbnail.url }}" width="200" height="200">
<p>{{ item.inventory.product_id.name }}</p>
<p>{{ item.inventory.product_id.style }}</p>
<p>{{ item.inventory.size }}</p>
<p>{{ item.quantity }}</p>
<p>{{ item.inventory.product_id.price|intcomma }}</p>
{% endfor %}
<p>상품금액 000,000원</p>
<p>총 결제 예정금액 {{ request.session.order_info.total_price|intcomma }}원</p>
<h3>주문고객</h3>
<p>세션에서 주문고객 정보를 받아옵니다..</p>
<h3>배송지 정보</h3>
<p>받는 사람<input type="text" id="receive_name"></p>
<p>연락처<input type="text" id="receive_phone"></p>
<p>배송주소<input type="text" id="receive_address"></p>
<p>배송메모<input type="text" id="memo"></p>
<button onclick="next()">다음단계 진행</button>
<script>
  function next() {
    var receive_name = $("#receive_name").val();
    var receive_phone = $("#receive_phone").val();
    var receive_address = $("#receive_address").val();
    var memo = $("#memo").val();
    $.ajax({
      type: "POST",
      url: "{% url 'order:to-checkout2' %}",
      data: {receive_name: receive_name,
              receive_phone: receive_phone,
              receive_address: receive_address,
              memo: memo,
              csrfmiddlewaretoken: '{{ csrf_token }}'},
      success: function(response) {
        var answer = response.result;
        if (answer == 'success') {
          window.location.href = "{% url 'order:checkout2' %}";
        }
      }
    });
  }
</script>
</body>
</html>